# First stage: Build the executable
FROM golang:buster

ENV GO111MODULE on
ENV DISABLE_NEW_RELIC true

RUN apt update && apt install git
RUN apt install curl
RUN apt install unzip
RUN go get -u github.com/cortesi/modd/cmd/modd

WORKDIR /backend

# Install protobuf compiler
RUN curl -LO https://github.com/protocolbuffers/protobuf/releases/download/v3.14.0/protoc-3.14.0-linux-x86_64.zip
RUN unzip protoc-3.14.0-linux-x86_64.zip -d /usr/local

RUN GO111MODULE=on go get google.golang.org/protobuf/cmd/protoc-gen-go google.golang.org/grpc/cmd/protoc-gen-go-grpc
